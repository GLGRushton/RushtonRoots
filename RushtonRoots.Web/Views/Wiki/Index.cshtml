@{
    ViewData["Title"] = "Family Wiki";
}

@section Styles {
    <link rel="stylesheet" href="~/css/wiki.css" asp-append-version="true" />
}

<div class="wiki-page">
    <!-- Determine view mode: if articleId or slug is provided, show article; otherwise show index -->
    @{
        var articleId = Context.Request.Query["articleId"].ToString();
        var articleSlug = Context.Request.Query["slug"].ToString();
        var showArticle = !string.IsNullOrEmpty(articleId) || !string.IsNullOrEmpty(articleSlug);
    }

    @if (showArticle)
    {
        <!-- Display Wiki Article -->
        <app-wiki-article 
            @if (!string.IsNullOrEmpty(articleId)) { <text>article-id="@articleId"</text> }
            @if (!string.IsNullOrEmpty(articleSlug)) { <text>article-slug="@articleSlug"</text> }>
        </app-wiki-article>
        
        <noscript>
            <div class="alert alert-warning">
                <strong>JavaScript Required</strong>
                <p>This wiki article requires JavaScript to display properly. Please enable JavaScript in your browser.</p>
            </div>
        </noscript>
    }
    else
    {
        <!-- Display Wiki Index -->
        <app-wiki-index></app-wiki-index>
        
        <noscript>
            <div class="alert alert-warning">
                <strong>JavaScript Required</strong>
                <p>The wiki knowledge base requires JavaScript to display properly. Please enable JavaScript in your browser.</p>
            </div>
        </noscript>
    }
</div>

@section Scripts {
    <script src="~/runtime.js" asp-append-version="true"></script>
    <script src="~/polyfills.js" asp-append-version="true"></script>
    <script src="~/main.js" asp-append-version="true"></script>
}
