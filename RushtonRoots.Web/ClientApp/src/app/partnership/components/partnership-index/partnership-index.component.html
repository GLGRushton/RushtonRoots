<div class="partnership-index-container">
  <!-- Header -->
  <div class="index-header">
    <div class="header-content">
      <h1 class="page-title">Partnerships</h1>
      <p class="page-subtitle">Manage family relationships and partnerships</p>
    </div>
    <button 
      mat-raised-button 
      color="primary" 
      *ngIf="canCreate"
      (click)="createPartnership()">
      <mat-icon>add</mat-icon>
      New Partnership
    </button>
  </div>

  <!-- Search and Filters -->
  <div class="search-filters-section">
    <mat-card>
      <mat-card-content>
        <!-- Search Bar -->
        <div class="search-bar">
          <mat-form-field appearance="outline" class="search-field">
            <mat-label>Search partnerships</mat-label>
            <input 
              matInput 
              [(ngModel)]="searchText"
              (ngModelChange)="onSearchChange($event)"
              placeholder="Search by name, type, or location...">
            <mat-icon matPrefix>search</mat-icon>
            <button 
              mat-icon-button 
              matSuffix 
              *ngIf="searchText"
              (click)="clearSearch()">
              <mat-icon>clear</mat-icon>
            </button>
          </mat-form-field>

          <!-- Sort Selector -->
          <mat-form-field appearance="outline" class="sort-field">
            <mat-label>Sort by</mat-label>
            <mat-select [(value)]="currentSort" (selectionChange)="onSortChange($event.value)">
              <mat-option *ngFor="let option of sortOptions" [value]="option">
                {{ option.display }}
              </mat-option>
            </mat-select>
            <mat-icon matPrefix>sort</mat-icon>
          </mat-form-field>
        </div>

        <!-- Advanced Filters -->
        <div class="advanced-filters">
          <!-- Partnership Type Filter -->
          <mat-form-field appearance="outline" class="filter-field">
            <mat-label>Partnership Type</mat-label>
            <mat-select [(ngModel)]="filters.partnershipType" (selectionChange)="onFilterChange()">
              <mat-option [value]="undefined">All Types</mat-option>
              <mat-option *ngFor="let type of partnershipTypes" [value]="type.value">
                <mat-icon>{{ type.icon }}</mat-icon>
                {{ type.display }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Status Filter -->
          <mat-form-field appearance="outline" class="filter-field">
            <mat-label>Status</mat-label>
            <mat-select [(ngModel)]="filters.status" (selectionChange)="onFilterChange()">
              <mat-option [value]="undefined">All Statuses</mat-option>
              <mat-option value="current">Current</mat-option>
              <mat-option value="ended">Ended</mat-option>
              <mat-option value="divorced">Divorced</mat-option>
              <mat-option value="widowed">Widowed</mat-option>
              <mat-option value="separated">Separated</mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Clear Filters Button -->
          <button 
            mat-stroked-button 
            *ngIf="getActiveFilterCount() > 0"
            (click)="clearFilters()"
            class="clear-filters-btn">
            <mat-icon>clear_all</mat-icon>
            Clear Filters ({{ getActiveFilterCount() }})
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Results Summary -->
  <div class="results-summary">
    <span class="results-count">
      {{ filteredPartnerships.length }} 
      {{ filteredPartnerships.length === 1 ? 'partnership' : 'partnerships' }} found
    </span>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <mat-spinner></mat-spinner>
    <p>Loading partnerships...</p>
  </div>

  <!-- Partnership Grid -->
  <div class="partnership-grid" *ngIf="!loading && filteredPartnerships.length > 0">
    <div 
      class="grid-item" 
      *ngFor="let partnership of filteredPartnerships"
      [style.width]="'calc(' + (100 / gridColumns) + '% - 16px)'">
      <app-partnership-card
        [partnership]="partnership"
        [canEdit]="canEdit"
        [canDelete]="canDelete"
        (action)="onCardAction($event)">
      </app-partnership-card>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!loading && filteredPartnerships.length === 0">
    <mat-icon class="empty-icon">favorite_border</mat-icon>
    <h3>No partnerships found</h3>
    <p *ngIf="getActiveFilterCount() > 0">
      Try adjusting your filters or search terms.
    </p>
    <p *ngIf="getActiveFilterCount() === 0 && partnerships.length === 0">
      Start by creating your first partnership.
    </p>
    <button 
      mat-raised-button 
      color="primary" 
      *ngIf="canCreate && partnerships.length === 0"
      (click)="createPartnership()">
      <mat-icon>add</mat-icon>
      Create Partnership
    </button>
    <button 
      mat-stroked-button 
      *ngIf="getActiveFilterCount() > 0"
      (click)="clearFilters()">
      Clear Filters
    </button>
  </div>
</div>
